import pytest
from fastapi.testclient import TestClient
from samplemovapitesting import app  
 
client = TestClient(app)
 
def test_movfunction_valid_input():
    input_data = '{"Valve_id": 123, "KPI_Name": "Movement", "KPI_Units": "mm", "Tests": [{"PR_high": 10.5, "PR_low": 5.0}]}'
    config_data = '{"Movement_Config": {"Min_Move": 2.0, "Max_Move": 6.0}}'
    response = client.post(
        "/mov/",
        data={"input": input_data, "config": config_data}
    )
    assert response.status_code == 200
    result = response.json()
    assert result["response_code"] == 200
    assert "result_" in result
 
def test_movfunction_invalid_input():
    input_data = '{"Valve_id": "abc", "KPI_Name": "Movement", "KPI_Units": "mm", "Tests": []}'
    config_data = '{"Movement_Config": {"Min_Move": 2.0, "Max_Move": 6.0}}'
    response = client.post(
        "/mov/",
        data={"input": input_data, "config": config_data}
    )
    assert response.status_code == 200
    result = response.json()
    assert result["response_code"] == 204
